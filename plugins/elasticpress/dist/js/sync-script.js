!function(){var e={2485:function(e,t){var s;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var s=arguments[t];if(s){var r=typeof s;if("string"===r||"number"===r)e.push(s);else if(Array.isArray(s)){if(s.length){var c=a.apply(null,s);c&&e.push(c)}}else if("object"===r){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){e.push(s.toString());continue}for(var l in s)n.call(s,l)&&s[l]&&e.push(l)}}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(s=function(){return a}.apply(t,[]))||(e.exports=s)}()}},t={};function s(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.wp.i18n,n=window.wp.components,a=window.wp.data,r=window.wp.notices;const c=(0,e.createContext)(),{Fill:l,Slot:i}=(0,n.createSlotFill)("SettingsPageAction"),o=({children:t,title:s})=>{const{createNotice:o,removeNotice:u}=(0,a.useDispatch)(r.store),{notices:p}=(0,a.useSelect)((e=>({notices:e(r.store).getNotices()})),[]),m=(0,e.useMemo)((()=>({ActionSlot:l,createNotice:o,removeNotice:u})),[o,u]);return React.createElement(n.SlotFillProvider,null,React.createElement(c.Provider,{value:m},React.createElement("div",{className:"ep-settings-page"},React.createElement("div",{className:"ep-settings-page__wrap"},React.createElement("header",{className:"ep-settings-page__header"},React.createElement("h1",{className:"ep-settings-page__title"},s),React.createElement(i,null)),t),React.createElement(n.SnackbarList,{className:"ep-settings-page__snackbar-list",notices:p,onRemove:e=>u(e)}))))},u=()=>(0,e.useContext)(c);var p={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let m;const d=new Uint8Array(16);function y(){if(!m&&(m="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(d)}const _=[];for(let e=0;e<256;++e)_.push((e+256).toString(16).slice(1));function g(e,t=0){return _[e[t+0]]+_[e[t+1]]+_[e[t+2]]+_[e[t+3]]+"-"+_[e[t+4]]+_[e[t+5]]+"-"+_[e[t+6]]+_[e[t+7]]+"-"+_[e[t+8]]+_[e[t+9]]+"-"+_[e[t+10]]+_[e[t+11]]+_[e[t+12]]+_[e[t+13]]+_[e[t+14]]+_[e[t+15]]}var h=function(e,t,s){if(p.randomUUID&&!t&&!e)return p.randomUUID();const n=(e=e||{}).random||(e.rng||y)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=n[e];return t}return g(n)},f=window.wp.date;const b=e=>{let t=0;return e.current_sync_item&&(t+=e.current_sync_item.found_items),t=e.sync_stack.reduce(((e,t)=>e+t.found_items),t),t+=e.totals.failed,t+=e.totals.skipped,t+=e.totals.synced,t},E=e=>{let t=0;return e.current_sync_item&&(t+=e.current_sync_item.failed,t+=e.current_sync_item.skipped,t+=e.current_sync_item.synced),t+=e.totals.failed,t+=e.totals.skipped,t+=e.totals.synced,t},R=(0,e.createContext)(),w=({apiUrl:s,children:n,defaultSyncHistory:a,defaultSyncTrigger:r,indexMeta:c,isEpio:l,nonce:i})=>{const{cancelIndex:o,index:u,indexStatus:p}=((s,n)=>{const a=(0,e.useRef)(new AbortController),r=(0,e.useRef)(null),c=(0,e.useCallback)((async e=>{const s=await e.text(),n=`${(0,t.__)("ElasticPress: Unexpected response.","elasticpress")}\n${s}`;if(!e.ok)throw 403===e.status?new Error((0,t.__)("Permission denied. Reload the sync page and try again.","elasticpress")):(console.error(n),new Error((0,t.__)("Something went wrong. Find troubleshooting steps at https://www.elasticpress.io/documentation/article/troubleshooting-guide-elasticpress-something-went-wrong-error/.","elasticpress")));try{return JSON.parse(s)}catch(e){throw console.error(e.message),console.error(n),new Error((0,t.__)("Unable to parse response. Find troubleshooting steps at https://www.elasticpress.io/documentation/article/troubleshooting-guide-elasticpress-something-went-wrong-error/.","elasticpress"))}}),[]),l=(0,e.useCallback)((()=>{r.current=null}),[]),i=(0,e.useCallback)(((e,t)=>(r.current=fetch(e,t).then(c).finally(l),r.current)),[l,c]);return{cancelIndex:(0,e.useCallback)((async()=>{a.current.abort(),a.current=new AbortController;const e=new URL(s),t={headers:{"X-WP-Nonce":n},method:"DELETE",signal:a.current.signal};return i(e,t)}),[s,n,i]),index:(0,e.useCallback)((async e=>{a.current.abort(),a.current=new AbortController;const t=new URL(s);Object.keys(e).forEach((s=>{e[s]&&t.searchParams.append(s,e[s])}));const r={headers:{"X-WP-Nonce":n},method:"POST",signal:a.current.signal};return i(t,r)}),[s,n,i]),indexStatus:(0,e.useCallback)((async()=>{a.current.abort(),a.current=new AbortController;const e=new URL(s),t={headers:{"X-WP-Nonce":n},method:"GET",signal:a.current.signal};return i(e,t)}),[s,n,i])}})(s,i),[m,d]=(0,e.useState)([]),[y,_]=(0,e.useState)([]),[g,w]=(0,e.useState)({isCli:!1,isComplete:!1,isDeleting:!1,isFailed:!1,isPaused:!1,isSyncing:!1,itemsProcessed:0,itemsTotal:100,syncStartDateTime:null,syncHistory:a,syncTrigger:r}),C=(0,e.useRef)(g),S=e=>{C.current={...C.current,...e},w((t=>({...t,...e})))},v=(0,e.useCallback)((e=>{_((t=>{const s=[...t];return Object.keys(e).forEach((t=>{if(!e[t].solution)return;const n=s.findIndex((e=>t===e.type));-1!==n?s[n].count+=e[t].count:s.push({...e[t],type:t})})),s}))}),[]),x=(0,e.useCallback)(((e,t)=>{const{isDeleting:s}=C.current,n=Array.isArray(e)?e:[e];for(const e of n)d((n=>[...n,{message:e,status:t,dateTime:(0,f.dateI18n)("Y-m-d H:i:s",new Date),isDeleting:s,id:h()}]))}),[]),P=(0,e.useCallback)((()=>{d([]),_([])}),[d]),N=(0,e.useCallback)((e=>{S({isComplete:!0,isPaused:!1,isSyncing:!1,syncHistory:[e,...C.current.syncHistory]}),document.querySelector('[data-ep-notice="no_sync"]')?.remove()}),[]),k=(0,e.useCallback)((e=>{if("AbortError"===e.name)return;e.message&&x(e.message,"error");const s=e.totals?[e.totals,...C.current.syncHistory]:C.current.syncHistory;x((0,t.__)("Sync failed","elasticpress"),"error"),S({isFailed:!0,isSyncing:!1,syncHistory:s})}),[x]),T=(0,e.useCallback)((()=>{const{isDeleting:e}=C.current,s=e?(0,t.sprintf)((0,t.__)("Your indexing process has been stopped by WP-CLI and your %s index could be missing content. To restart indexing, please click the Start button or use WP-CLI commands to perform the reindex. Please note that search results could be incorrect or incomplete until the reindex finishes.","elasticpress"),l?(0,t.__)("ElasticPress.io","elasticpress"):(0,t.__)("Elasticsearch","elasticpress")):(0,t.__)("Sync interrupted by WP-CLI command.","elasticpress");x(s,"info"),S({isSyncing:!1})}),[l,x]),I=(0,e.useCallback)((e=>{S({isCli:"cli"===e.method,isSyncing:!0,itemsProcessed:E(e),itemsTotal:b(e),syncStartDateTime:e.start_date_time,syncTrigger:e.trigger||null})}),[]),M=(0,e.useCallback)((e=>{const t=e.data?[e.data,...C.current.syncHistory]:C.current.syncHistory;S({syncHistory:t})}),[]),L=(0,e.useCallback)((e=>{const{isPaused:s,isSyncing:n}=C.current,{errors:a,message:r,status:c,totals:l=[],index_meta:i}=e.data;return new Promise((o=>{n&&(a&&v(a),"error"!==c?(r&&x(r,c),Array.isArray(l)?(I(i),i.should_interrupt_sync?T():s?x((0,t.__)("Sync paused","elasticpress"),"info"):o(i.method)):N(l)):k(e.data))}))}),[N,k,I,T,v,x]),D=(0,e.useCallback)((()=>{o().then(M).catch((e=>{if("AbortError"!==e?.name)throw e}))}),[o,M]),j=(0,e.useCallback)((()=>{p().then(L).then(j).catch(k)}),[p,k,L]),H=(0,e.useCallback)((e=>{u(e).then(L).then((t=>{"cli"===t?j():H(e)})).catch(k)}),[j,u,k,L]),A=(0,e.useCallback)((()=>{S({isPaused:!0,isSyncing:!0})}),[]),F=(0,e.useCallback)((e=>{S({isPaused:!1,isSyncing:!0}),H(e)}),[H]),B=(0,e.useCallback)((e=>{const{syncHistory:t}=C.current,s=!(!!t.length&&!e.put_mapping);S({isComplete:!1,isFailed:!1,isDeleting:s,isPaused:!1,isSyncing:!0}),S({itemsProcessed:0,syncStartDateTime:Date.now(),syncTrigger:e.trigger||null}),H(e)}),[H]),U=(0,e.useCallback)((()=>{S({isPaused:!1,isSyncing:!1}),D()}),[D]);(0,e.useEffect)((()=>{(()=>{const e=new URL(document.location.href);e.searchParams.delete("do_sync"),e.searchParams.delete("ep_sync_nonce"),window.history.replaceState({},document.title,e)})(),c&&(I(c),"cli"===c.method?(j(),x((0,t.__)("WP CLI sync in progress","elasticpress"),"info")):(A(),x((0,t.__)("Sync paused","elasticpress"),"info")))}),[j,I,c,x,A,B]);const{isCli:O,isComplete:W,isDeleting:$,isFailed:Z,isPaused:V,isSyncing:Y,itemsProcessed:G,itemsTotal:X,syncHistory:z,syncStartDateTime:q,syncTrigger:J}=C.current,K={clearLog:P,errorCounts:y,isCli:O,isComplete:W,isDeleting:$,isFailed:Z,isPaused:V,isSyncing:Y,itemsProcessed:G,itemsTotal:X,syncHistory:z,log:m,logMessage:x,pauseSync:A,resumeSync:F,startSync:B,stopSync:U,syncStartDateTime:q,syncTrigger:J};return React.createElement(R.Provider,{value:K},n)},C=()=>(0,e.useContext)(R),{autoIndex:S,apiUrl:v,indexMeta:x,indexables:P,isEpio:N,nonce:k,postTypes:T,syncHistory:I,syncTrigger:M}=window.epDash,L=(0,e.createContext)(),D=({autoIndex:t,children:s,indexables:n,postTypes:c})=>{const{createNotice:l}=(0,a.useDispatch)(r.store),[i,o]=(0,e.useState)({include:[],indexables:[],lower_limit_object_id:null,offset:0,put_mapping:!1,post_type:[],upper_limit_object_id:null}),[u,p]=(0,e.useState)(!1),m=(0,e.useMemo)((()=>({args:i,autoIndex:t,createNotice:l,indexables:n,postTypes:c,setArgs:o,showLog:u,setShowLog:p})),[i,t,l,n,c,o,u,p]);return React.createElement(L.Provider,{value:m},s)},j=()=>(0,e.useContext)(L);var H=()=>{const{isPaused:e,isSyncing:s,logMessage:a,pauseSync:r,resumeSync:c,stopSync:l}=C(),{args:i}=j();return React.createElement("div",{className:"ep-sync-controls"},s?React.createElement(React.Fragment,null,React.createElement(n.Button,{onClick:()=>{l(),a((0,t.__)("Sync stopped","elasticpress"),"info")},variant:"primary"},(0,t.__)("Stop sync","elasticpress")),e?React.createElement(n.Button,{onClick:()=>{c(i),a((0,t.__)("Resuming sync…","elasticpress"),"info")},variant:"secondary"},(0,t.__)("Resume sync","elasticpress")):React.createElement(n.Button,{onClick:()=>{r(),a((0,t.__)("Pausing sync…","elasticpress"),"info")},variant:"secondary"},(0,t.__)("Pause sync","elasticpress"))):React.createElement(n.Button,{variant:"primary",type:"submit"},(0,t.__)("Start sync","elasticpress")),React.createElement(n.Button,{href:"https://www.elasticpress.io/documentation/article/what-is-the-elasticpress-sync/",target:"_blank",variant:"link"},(0,t.__)("Learn more about Sync","elasticpress")))},A=()=>{const{isSyncing:e}=C(),{args:s,indexables:a,setArgs:r}=j();return a.length>1?React.createElement("fieldset",{className:"ep-sync-advanced-control"},React.createElement("legend",{className:"ep-sync-advanced-control__label"},(0,t.__)("Content to sync","elasticpress")),a.map((([t,a])=>React.createElement(n.CheckboxControl,{checked:s.indexables?.includes(t),disabled:e,indeterminate:!s.indexables.length,key:t,label:a,onChange:e=>((e,t)=>{const n=s.indexables?[...s.indexables]:[];t?n.push(e):n.splice(n.indexOf(e),1);const a=!n.length||n.includes("post")?s.post_type:[];r({...s,indexables:n,post_type:a})})(t,e),__nextHasNoMarginBottom:!0})))):null},F=()=>{const{isSyncing:e}=C(),{args:s,postTypes:a,setArgs:r}=j();return a.length>1?React.createElement("fieldset",{className:"ep-sync-advanced-control"},React.createElement("legend",{className:"ep-sync-advanced-control__label"},(0,t.__)("Post types to sync","elasticpress")),a.map((([t,a])=>React.createElement(n.CheckboxControl,{checked:s.post_type.includes(t),disabled:e,indeterminate:!s.post_type.length,key:t,label:a,onChange:e=>((e,t)=>{const n=[...s.post_type];t?n.push(e):n.splice(n.indexOf(e),1),r({...s,post_type:n})})(t,e),__nextHasNoMarginBottom:!0})))):null},B=()=>{const{args:e}=j();return React.createElement(React.Fragment,null,React.createElement(A,null),!e.indexables.length||e.indexables.includes("post")?React.createElement(F,null):null)},U=window.wp.compose,O=window.wp.dom,W=()=>{const{errorCounts:s}=C();return React.createElement("div",{className:"ep-sync-errors"},s.length?React.createElement("table",{className:"ep-sync-errors__table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,(0,t.__)("Count","elasticpress")),React.createElement("th",null,(0,t.__)("Error type","elasticpress")))),s.map((t=>React.createElement("tr",{key:t.type},React.createElement("td",{className:"ep-sync-errors__count"},t.count),React.createElement("td",null,t.type,React.createElement(e.RawHTML,{className:"ep-sync-errors__solution"},(0,O.safeHTML)(t.solution))))))):React.createElement("p",null,(0,t.__)("No errors found in the log.","elasticpress")))},$=()=>{const{log:t}=C();return React.createElement("div",{className:"ep-sync-messages"},t.map((t=>React.createElement(e.Fragment,{key:t.id},React.createElement("div",{className:"ep-sync-messages__line-number",role:"presentation"},(0,f.dateI18n)("Y-m-d H:i:s",t.dateTime)),React.createElement("div",{className:`ep-sync-messages__message ep-sync-messages__message--${t.status}`},t.message)))))},Z=()=>{const{clearLog:s,errorCounts:a,log:r}=C(),{createNotice:c}=u(),l=(0,e.useMemo)((()=>a.reduce(((e,t)=>e+t.count),0)),[a]),i=(0,e.useMemo)((()=>r.map((e=>`${e.dateTime} ${e.message}`)).join("\n")),[r]),o=(0,U.useCopyToClipboard)(i,(()=>{c("info",(0,t.__)("Copied log to clipboard.","elasticpress"))})),p=[{name:"full",title:(0,t.__)("Log","elasticpress")},{name:"error",title:(0,t.sprintf)((0,t.__)("Errors (%d)","elasticpress"),l)}];return React.createElement(React.Fragment,null,React.createElement(n.TabPanel,{className:"ep-sync-log",initialTabName:l>0?"error":"full",tabs:p},(({name:e})=>{switch(e){case"full":return React.createElement($,null);case"error":return React.createElement(W,null);default:return null}})),React.createElement(n.Flex,{justify:"start"},React.createElement(n.FlexItem,null,React.createElement(n.Button,{disabled:!r.length,onClick:()=>{s()},variant:"secondary"},(0,t.__)("Clear log","elasticpress"))),React.createElement(n.FlexItem,null,React.createElement(n.Button,{disabled:!r.length,ref:o,variant:"secondary"},(0,t.__)("Copy log to clipboard","elasticpress")))))},V=()=>{const{isSyncing:e}=C(),{args:s,setArgs:a}=j();return React.createElement("div",{className:"ep-sync-advanced-control"},React.createElement(n.FormTokenField,{disabled:e,label:(0,t.__)("Object IDs","elasticpress"),onChange:e=>{a({...s,include:e})},saveTransform:e=>{const t=parseInt(e,10);return t?t.toString():""},value:s.include,__nextHasNoMarginBottom:!0}))},Y=()=>{const{isSyncing:e}=C(),{args:s,setArgs:a}=j();return React.createElement(n.Flex,{className:"ep-sync-advanced-control",justify:"start"},React.createElement(n.FlexItem,{grow:"2"},React.createElement(n.TextControl,{disabled:e,help:(0,t.__)("Sync objects with an ID of this number or higher.","elasticpress"),label:(0,t.__)("Lower object ID","elasticpress"),max:s.upper_limit_object_id,min:"0",onChange:e=>{const t=e?Math.max(0,e):e;a({...s,lower_limit_object_id:t})},type:"number",value:s.lower_limit_object_id,__nextHasNoMarginBottom:!0})),React.createElement(n.FlexItem,{grow:"2"},React.createElement(n.TextControl,{disabled:e,help:(0,t.__)("Sync objects with an ID of this number or lower.","elasticpress"),label:(0,t.__)("Higher object ID","elasticpress"),min:s.lower_limit_object_id,onChange:e=>{const t=e?Math.max(0,e):e;a({...s,upper_limit_object_id:t})},type:"number",value:s.upper_limit_object_id,__nextHasNoMarginBottom:!0})))},G=()=>{const{isSyncing:e}=C(),{args:s,setArgs:a}=j();return React.createElement(n.TextControl,{className:"ep-sync-advanced-control",disabled:e,help:(0,t.__)("Specify the number of objects to skip during syncing.","elasticpress"),label:(0,t.__)("Skip objects","elasticpress"),onChange:e=>a({...s,offset:e}),type:"number",value:s.offset,__nextHasNoMarginBottom:!0})},X=()=>{const[s,a]=(0,e.useState)("all"),{isSyncing:r}=C(),{args:c,setArgs:l}=j();return React.createElement(React.Fragment,null,React.createElement(n.RadioControl,{className:"ep-sync-advanced-control",disabled:r,label:(0,t.__)("Objects to sync","elasticpress"),onChange:e=>{let{include:t,lower_limit_object_id:s,offset:n,upper_limit_object_id:r}=c;switch(e){case"include":n=0,s=null,r=null;break;case"limits":n=0,t=[];break;default:t=[],s=null,r=null}l({...c,include:t,lower_limit_object_id:s,offset:n,upper_limit_object_id:r}),a(e)},options:[{label:"All objects",value:"all"},{label:(0,t.__)("Specific IDs","elasticpress"),value:"include"},{label:(0,t.__)("A range of IDs","elasticpress"),value:"limits"}],selected:s}),"all"===s?React.createElement(G,null):null,"include"===s?React.createElement(V,null):null,"limits"===s?React.createElement(Y,null):null)},z=s(2485),q=s.n(z),J=window.wp.primitives,K=()=>React.createElement(J.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},React.createElement(J.Path,{d:"M10.2 3.28c3.53 0 6.43 2.61 6.92 6h2.08l-3.5 4-3.5-4h2.32c-.45-1.97-2.21-3.45-4.32-3.45-1.45 0-2.73.71-3.54 1.78L4.95 5.66C6.23 4.2 8.11 3.28 10.2 3.28zm-.4 13.44c-3.52 0-6.43-2.61-6.92-6H.8l3.5-4c1.17 1.33 2.33 2.67 3.5 4H5.48c.45 1.97 2.21 3.45 4.32 3.45 1.45 0 2.73-.71 3.54-1.78l1.71 1.95c-1.28 1.46-3.15 2.38-5.25 2.38z"})),Q=()=>{const{isCli:s,isComplete:a,isFailed:r,isPaused:c,itemsProcessed:l,itemsTotal:i,syncStartDateTime:o,syncTrigger:u}=C(),p=(0,e.useMemo)((()=>r?(0,t.__)("Sync failed","elasticpress"):a?(0,t.__)("Sync complete","elasticpress"):c?(0,t.__)("Sync paused","elasticpress"):s?(0,t.__)("WP CLI sync in progress","elasticpress"):(0,t.__)("Sync in progress","elasticpress")),[s,a,r,c]),m=i?Math.floor(l/i*100):100,d=(0,e.useMemo)((()=>{if(s)return(0,t.__)("Started manually from WP CLI at <time>%s</time>.","elasticpress");switch(u){case"features":return(0,t.__)("Started automatically after a change to feature settings at <time>%s</time>.","elasticpress");case"install":return(0,t.__)("Started automatically after installing the ElasticPress plugin at <time>%s</time>.","elasticpress");case"manual":return(0,t.__)("Started manually from the Sync page at <time>%s</time>.","elasticpress");case"synonyms-error":return(0,t.__)("Started manually from an error on the Synonyms Settings page at <time>%s</time>.","elasticpress");case"upgrade":return(0,t.__)("Started automatically after updating the ElasticPress plugin at <time>%s</time>.","elasticpress");default:return(0,t.__)("Started on <time>%s</time>.","elasticpress")}}),[s,u]);return React.createElement("div",{className:q()("ep-sync-progress",{"ep-sync-progress--syncing":!c&&!a&&!r})},React.createElement(n.Icon,{icon:K}),React.createElement("div",{id:"ep-sync-progress-details",className:"ep-sync-progress__details"},React.createElement("strong",null,p),o?(0,e.createInterpolateElement)((0,t.sprintf)(d,(0,f.dateI18n)("g:ia l F jS, Y",o)),{time:React.createElement("time",{dateTime:(0,f.dateI18n)("c",o)})}):null),React.createElement("div",{className:"ep-sync-progress__progress-bar"},React.createElement("div",{"aria-labelledby":"ep-sync-progress-details","aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":m,className:q()("ep-sync-progress-bar",{"ep-sync-progress-bar--complete":a,"ep-sync-progress-bar--failed":r}),role:"progressbar"},React.createElement("div",{className:"ep-sync-progress-bar__progress",style:{minWidth:`${m}%`}}))))},ee=()=>{const{isDeleting:e,isSyncing:s}=C(),{args:a,setArgs:r}=j();return React.createElement(React.Fragment,null,a.put_mapping?React.createElement(n.Notice,{isDismissible:!1,status:"warning"},(0,t.__)("Search results could be out of date or returned in different order while the sync completes.","elasticpress")):null,React.createElement(n.CheckboxControl,{className:"ep-sync-delete",disabled:s,checked:a.put_mapping,help:(0,t.__)("All indexed data on ElasticPress will be deleted without affecting anything on your WordPress website. This may take a few hours depending on the amount of content that needs to be synced and indexed. While this is happening, searches will use the default WordPress results.","elasticpress"),indeterminate:s&&e&&!a.put_mapping,label:(0,t.__)("Delete all data and start fresh sync","elasticpress"),onChange:e=>r({...a,put_mapping:e}),__nextHasNoMarginBottom:!0}))},te=()=>React.createElement(J.SVG,{version:"1.1",xmlns:"https://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},React.createElement(J.Path,{d:"M 12 20.8 C 16.8 20.8 20.8 16.9 20.8 12 C 20.8 7.2 16.9 3.2 12 3.2 C 7.2 3.2 3.2 7.1 3.2 12 C 3.2 16.8 7.2 20.8 12 20.8 Z M 12 4.8 C 16 4.8 19.2 8.1 19.2 12 C 19.2 16 16 19.2 12 19.2 C 8 19.2 4.8 15.9 4.8 12 C 4.8 8 8 4.8 12 4.8 Z M 13 7 L 11 7 L 11 13 L 13 13 L 13 7 Z M 13 15 L 11 15 L 11 17 L 13 17 L 13 15 Z"})),se=()=>React.createElement(J.SVG,{version:"1.1",xmlns:"https://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},React.createElement(J.Path,{d:"M 12 3.25 C 9.679 3.25 7.454 4.172 5.813 5.813 C 4.172 7.454 3.25 9.679 3.25 12 C 3.25 14.32 4.172 16.546 5.813 18.187 C 7.454 19.828 9.679 20.75 12 20.75 C 14.321 20.75 16.546 19.828 18.187 18.187 C 19.828 16.546 20.75 14.32 20.75 12 C 20.75 9.679 19.828 7.454 18.187 5.813 C 16.546 4.172 14.321 3.25 12 3.25 Z M 4.75 12 C 4.75 11.048 4.938 10.105 5.302 9.225 C 5.666 8.346 6.2 7.547 6.874 6.873 C 7.547 6.2 8.346 5.666 9.226 5.302 C 10.105 4.937 11.048 4.75 12 4.75 C 12.952 4.75 13.895 4.937 14.775 5.302 C 15.654 5.666 16.453 6.2 17.127 6.873 C 17.8 7.547 18.334 8.346 18.698 9.225 C 19.063 10.105 19.25 11.048 19.25 12 C 19.25 13.923 18.486 15.767 17.127 17.126 C 15.767 18.486 13.923 19.25 12 19.25 C 10.077 19.25 8.233 18.486 6.874 17.126 C 5.514 15.767 4.75 13.923 4.75 12 Z"}),React.createElement(J.Path,{d:"M 15.974 8 L 10.59 15.217 L 7.769 13.094 L 7 14.113 L 10.846 17 L 17 8.764 L 15.974 8 Z"})),ne=({failures:s,method:a,stateDatetime:r,status:c,trigger:l})=>{const i=(0,e.useMemo)((()=>(0,f.dateI18n)("l F j, Y g:ia",r)),[r]),o=(0,e.useMemo)((()=>{switch(c){case"failed":return(0,t.__)("Failed.","elasticpress");case"with_errors":return s?(0,t.sprintf)((0,t._n)("Completed with %d error.","Completed with %d errors.",s,"elasticpress"),s):(0,t.__)("Completed with errors.","elasticpress");case"aborted":return(0,t.__)("Stopped.","elasticpress");case"success":return(0,t.__)("Completed successfully.","elasticpress");default:return(0,t.__)("Completed.","elasticpress")}}),[s,c]),u=(0,e.useMemo)((()=>{if("cli"===a)return(0,t.__)("Manual sync from WP CLI.","elasticpress");switch(l){case"features":return(0,t.__)("Automatic sync after settings change.","elasticpress");case"install":return(0,t.__)("Automatic sync after installation.","elasticpress");case"synonyms-error":return(0,t.__)("Manual sync following an error in synonyms settings.","elasticpress");case"manual":return(0,t.__)("Manual sync from Sync Settings.","elasticpress");case"upgrade":return(0,t.__)("Automatic sync after plugin update.","elasticpress");default:return null}}),[a,l]),p=(0,e.useMemo)((()=>"failed"===c||"with_errors"===c||"aborted"===c),[c]),m=(0,e.useMemo)((()=>"success"===c),[c]);return React.createElement("div",{className:q()("ep-previous-sync",{"is-error":p,"is-success":m})},React.createElement(n.Icon,{icon:p?te:se}),React.createElement("div",{className:"ep-previous-sync__title"},u?(0,t.sprintf)((0,t._x)("%1$s — %2$s","Sync info","elasticpress"),i,u):i),React.createElement("div",{className:"ep-previous-sync__help"},o))},ae=()=>{const{syncHistory:e}=C(),t=e.slice(0,5);return React.createElement("ol",{className:"ep-sync-history"},t.map((e=>React.createElement("li",{key:e.start_date_time},React.createElement(ne,{failures:e.failed,method:e.method,stateDatetime:e.start_date_time,status:e.final_status,trigger:e.trigger})))))},re=()=>{const{createNotice:s}=u(),{errorCounts:a,isComplete:r,isEpio:c,isSyncing:l,logMessage:i,startSync:o,syncHistory:p,syncTrigger:m}=C(),{args:d,autoIndex:y}=j(),[_,g]=(0,e.useState)(!1),[h,f]=(0,e.useState)(0);return(0,e.useEffect)((()=>{if(r){const e=a.reduce(((e,t)=>e+t.count),0);s("success",(0,t.__)("Sync completed.","elasticpress")),e>h&&g(!0),f(e)}}),[s,h,a,r]),(0,e.useEffect)((()=>{y&&(o({put_mapping:!0,trigger:m}),i((0,t.__)("Starting delete and sync…","elasticpress"),"info"))}),[y,i,o,m]),React.createElement("form",{onSubmit:async e=>{e.preventDefault();const{put_mapping:s}=d,n=!p.length||s,a={...d,put_mapping:n,trigger:"manual"};o(a),i((0,t.__)("Starting sync…","elasticpress"),"info")}},React.createElement("p",null,p.length?(0,t.__)("If you are missing data in your search results or have recently added custom content types to your site, you should run a sync to reflect these changes.","elasticpress"):(0,t.sprintf)((0,t.__)("Run a sync to index your existing content %s. Once syncing finishes, your site is officially supercharged.","elasticpress"),c?(0,t.__)("on ElasticPress.io","elasticpress"):(0,t.__)("in Elasticsearch","elasticpress"))),React.createElement(n.Panel,{className:"ep-sync-panel"},React.createElement(n.PanelBody,{className:"ep-sync-panel__controls"},l||r?React.createElement(Q,null):null,React.createElement(H,null),p.length?React.createElement(ee,null):null),React.createElement(n.PanelBody,{onToggle:e=>{g(e)},opened:_,title:"Log"},React.createElement(Z,null)),p.length?React.createElement(React.Fragment,null,React.createElement(n.PanelBody,{className:"ep-sync-panel__advanced",initialOpen:!1,title:(0,t.__)("Advanced options","elasticpress")},React.createElement(B,null),React.createElement(X,null)),React.createElement(n.PanelBody,{title:(0,t.__)("Sync history","elasticpress")},React.createElement(ae,null))):null))};const ce=()=>React.createElement(w,{apiUrl:v,defaultSyncHistory:I,defaultSyncTrigger:M,indexMeta:x,isEpio:N,nonce:k},React.createElement(D,{autoIndex:S,indexables:P,postTypes:T},React.createElement(o,{title:(0,t.__)("Sync Settings","elasticpress")},React.createElement(re,null))));if("function"===typeof e.createRoot){(0,e.createRoot)(document.getElementById("ep-sync")).render(React.createElement(ce,null))}else(0,e.render)(React.createElement(ce,null),document.getElementById("ep-sync"))}()}();