!function(t){function e(e){var n=t(e).serializeArray().reduce(i,{});return t(e).find('input[type="checkbox"]').each(function(e){var i=t(this).prop("name");if(i.includes("[]")){if(!t(this).is(":checked"))return;var s=i.replace("[]","");n[s]||(n[s]=[]),n[s].push(t(this).val())}else n[i]=t(this).is(":checked")?"true":"false"}),n}function i(t,e){return e.name.includes("[]")?t:(t[e.name]=e.value,t)}var n=window.wp_optimize||{},s=n.send_command,a=wpoptimize.refresh_frequency||3e4;if(!s)return void console.error("WP-Optimize Minify: wp_optimize.send_command is required.");var o={};o.init=function(){function i(t){return t.data("url")}function n(e){var i=t("#exclude_js"),n=i.val();n+=e+"\n",i.val(n)}function a(e){var i=t("#exclude_css"),n=i.val();n+=e+"\n",i.val(n)}function o(e){var i=e.data("url"),n=t("#async_js"),s=n.val();s+=i+"\n",n.val(s),p("js"),l(e)}function c(e){var i=e.data("url"),n=t("#async_css"),s=n.val();s+=i+"\n",n.val(s),p("css"),l(e)}function p(e){t("#wp-optimize-nav-tab-wpo_minify-"+e+"-contents form").data("need_saving",!0)}function l(e){e.closest(".wpo_min_log").prev().removeClass("hidden").addClass("updated").slideDown(),e.text(wpoptimize.added_to_list),e.removeClass("exclude"),e.parent().addClass("disable-list-item"),e.replaceWith(t("<span>"+e.text()+"</span>"))}function r(e){t('input[name="enable_defer_js"]').each(function(e,i){t(i).closest("fieldset").removeClass("selected").find(".defer-js-settings").slideUp("fast")}),t('input[name="enable_defer_js"]:checked').closest("fieldset").addClass("selected").find(".defer-js-settings").slideDown("fast")}function d(){w||(w=setInterval(function(){u()},5e3))}function u(){s("get_minify_preload_status",null,function(t){t.done?(m.val(wpoptimize.run_now),m.data("running",!1),clearInterval(w),w=null):(m.val(wpoptimize.cancel),m.data("running",!0)),h.text(t.message),f(t)})}function f(e){t("#wpo_min_cache_size").text(e.size),t("#wpo_min_cache_total_size").text(e.total_size)}var _=this;this.enabled=!1,t(document).on("wp-optimize/minify/toggle-status",function(e,i){i.hasOwnProperty("enabled")&&(t('[data-whichpage="wpo_minify"]').toggleClass("is-enabled",i.enabled),_.enabled=i.enabled,_.enabled&&_.getFiles())}),t(".purge_minify_cache").on("click",function(e){e.preventDefault(),t.blockUI(),s("purge_minify_cache",null,function(t){_.updateFilesLists(t.files),_.updateStats(t.files)}).always(function(){t.unblockUI()})}),t(".purge_all_minify_cache").on("click",function(){t.blockUI(),s("purge_all_minify_cache",null,function(t){_.updateFilesLists(t.files),_.updateStats(t.files)}).always(function(){t.unblockUI()})}),t(".minify_increment_cache").on("click",function(){t.blockUI(),s("minify_increment_cache",null,function(t){t.hasOwnProperty("files")&&(_.updateFilesLists(t.files),_.updateStats(t.files))}).always(function(){t.unblockUI()})}),t("#wp-optimize-nav-tab-wpo_minify-status-contents form :input, #wp-optimize-nav-tab-wpo_minify-js-contents form :input, #wp-optimize-nav-tab-wpo_minify-css-contents form :input, #wp-optimize-nav-tab-wpo_minify-font-contents form :input, #wp-optimize-nav-tab-wpo_minify-settings-contents form :input, #wp-optimize-nav-tab-wpo_minify-advanced-contents form :input").on("change",function(){t(this).closest("form").data("need_saving",!0)}),t("input[type=checkbox].wpo-save-setting").on("change",function(e){var i=t(this),n=i.prop("checked"),a=i.prop("name"),o={};o[a]=n,t.blockUI(),s("save_minify_settings",o,function(t){t.success?(i.trigger("wp-optimize/minify/saved_setting"),t.hasOwnProperty("files")&&(_.updateFilesLists(t.files),_.updateStats(t.files))):console.log("Settings not saved",o)}).always(function(){t.unblockUI()})}),t("#wpo_min_enable_minify").on("wp-optimize/minify/saved_setting",function(){this.enabled=t(this).prop("checked"),t(document).trigger("wp-optimize/minify/toggle-status",{enabled:this.enabled})}),t("#wpo_min_enable_minify").on("wp-optimize/minify/saved_setting",function(){t(this).closest(".wpo_section").toggleClass("wpo-feature-is-disabled",!t(this).is(":checked"))}),t("#wpo_min_enable_minify_css, #wpo_min_enable_minify_js").on("wp-optimize/minify/saved_setting",function(){t('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="'+t(this).data("tabname")+'"] span.disabled').toggleClass("hidden",t(this).is(":checked"))}).each(function(){t('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="'+t(this).data("tabname")+'"] span.disabled').toggleClass("hidden",t(this).is(":checked"))}),t("#wpo_min_enable_minify_debug").on("wp-optimize/minify/saved_setting",function(){t.blockUI({message:"<h1>"+wpoptimize.page_refresh+"</h1>"}),location.href=t("#wp-optimize-nav-tab-wpo_minify-advanced").prop("href")}),t("#wpo_min_edit_default_exclutions").on("wp-optimize/minify/saved_setting",function(){t(".wpo-minify-default-exclusions").toggleClass("hidden",!t(this).prop("checked"))}),t(".wp-optimize-save-minify-settings").on("click",function(i){i.preventDefault();var n=t(this),a=n.next(),o=a.next();a.show(),t.blockUI();var c={},p=t('[data-whichpage="wpo_minify"] .wp-optimize-nav-tab-contents form');p.each(function(){var i=t(this);!0===i.data("need_saving")&&(c=Object.assign(c,e(i)),i.data("need_saving",!1))}),s("save_minify_settings",c,function(e){e.hasOwnProperty("error")?(console.log(e.error),t(".wpo-error__enabling-cache").removeClass("wpo_hidden").find("p").text(e.error.message)):t(".wpo-error__enabling-cache").addClass("wpo_hidden").find("p").text(""),e.hasOwnProperty("files")&&(_.updateFilesLists(e.files),_.updateStats(e.files)),a.hide(),o.show(),setTimeout(function(){o.fadeOut("slow",function(){o.hide()})},5e3)}).always(function(){t.unblockUI()})}),t(".wp-optimize-minify-status-information-notice").on("click",".notice-dismiss",function(t){t.preventDefault(),s("hide_minify_notice")}),t("#wpo_min_jsprocessed, #wpo_min_cssprocessed").on("click",".log",function(e){e.preventDefault(),t(this).nextAll(".wpo_min_log").slideToggle("fast")}),t("#wpo_min_jsprocessed").on("click",".exclude",function(e){e.preventDefault();var s=t(this),a=i(s);n(a),p("js"),l(s)}),t("#wpo_min_cssprocessed").on("click",".exclude",function(e){e.preventDefault();var n=t(this),s=i(n);a(s),p("css"),l(n)}),t("#wpo_min_jsprocessed").on("click",".defer",function(e){e.preventDefault(),o(t(this))}),t("#wpo_min_cssprocessed").on("click",".async",function(e){e.preventDefault(),c(t(this))}),t("#wp-optimize-minify-advanced").on("click",".save-exclusions",function(e){e.preventDefault(),t(".wp-optimize-save-minify-settings").first().trigger("click")}),this.enabled=t("#wpo_min_enable_minify").prop("checked"),t(document).trigger("wp-optimize/minify/toggle-status",{enabled:this.enabled}),this.enabled||t('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="status"]').is(".nav-tab-active")||t('#wp-optimize-nav-tab-wrapper__wpo_minify a[data-tab="status"]').trigger("click"),t('input[name="enable_defer_js"]').on("change",r),r();var m=t("#wp_optimize_run_minify_preload"),h=t("#wp_optimize_preload_minify_status"),w=null;return m.on("click",function(){var e=t(this),i=e.data("running"),n=h.text();e.prop("disabled",!0),i?(e.data("running",!1),clearInterval(w),w=null,s("cancel_minify_preload",null,function(t){t&&t.hasOwnProperty("message")&&h.text(t.message)}).always(function(){e.val(wpoptimize.run_now),e.prop("disabled",!1)})):(h.text(wpoptimize.starting_preload),e.data("running",!0),s("run_minify_preload",null,null,!0,{timeout:3e3}).always(function(t){try{var i=wpo_parse_json(t)}catch(s){}if(i&&i.error){var a=wpoptimize.error_unexpected_response;return"function"!=typeof i.error?a=i.error:i.status&&(a=i.status+": "+i.statusText),alert(a),h.text(n),e.prop("disabled",!1),void e.data("running",!1)}h.text(wpoptimize.loading_urls),e.val(wpoptimize.cancel),e.prop("disabled",!1),d()}))}),m.data("running")&&d(),this},o.getFiles=function(){if(this.enabled){var t={stamp:(new Date).getTime()};s("get_minify_cached_files",t,function(t){o.updateFilesLists(t),o.updateStats(t)}),a&&setTimeout(o.getFiles.bind(this),a)}},o.updateFilesLists=function(e){var i=[];e.js.length>0&&t(e.js).each(function(){i.push(this.uid),0==t("#"+this.uid).length&&t("#wpo_min_jsprocessed ul.processed").append('\t\t\t\t\t<li id="'+this.uid+'">\t\t\t\t\t\t<span class="filename"><a href="'+this.file_url+'" target="_blank">'+this.filename+"</a> ("+this.fsize+')</span>\t\t\t\t\t\t<a href="#" class="log">'+wpoptimize.toggle_info+'</a>\t\t\t\t\t\t<div class="hidden save_notice">\t\t\t\t\t\t\t<p>'+wpoptimize.added_notice+'</p>\t\t\t\t\t\t\t<p><button class="button button-primary save-exclusions">'+wpoptimize.save_notice+'</button></p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="hidden wpo_min_log">'+this.log+"</div>\t\t\t\t\t</li>\t\t\t\t")}),t("#wpo_min_jsprocessed ul.processed .no-files-yet").toggle(!e.js.length),e.css.length>0&&t(e.css).each(function(){i.push(this.uid),0==t("#"+this.uid).length&&t("#wpo_min_cssprocessed ul.processed").append('\t\t\t\t\t<li id="'+this.uid+'">\t\t\t\t\t\t<span class="filename"><a href="'+this.file_url+'" target="_blank">'+this.filename+"</a> ("+this.fsize+')</span>\t\t\t\t\t\t<a href="#" class="log">'+wpoptimize.toggle_info+'</a>\t\t\t\t\t\t<div class="hidden save_notice">\t\t\t\t\t\t\t<p>'+wpoptimize.added_to_list+'</p>\t\t\t\t\t\t\t<p><button class="button button-primary save-exclusions">'+wpoptimize.save_notice+'</button></p>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div class="hidden wpo_min_log">'+this.log+"</div>\t\t\t\t\t</li>\t\t\t\t")}),t("#wpo_min_cssprocessed ul.processed .no-files-yet").toggle(!e.css.length),t("#wpo_min_jsprocessed ul.processed > li, #wpo_min_cssprocessed ul.processed > li").each(function(){-1==jQuery.inArray(t(this).attr("id"),i)&&(t(this).is(".no-files-yet")||t(this).remove())})},o.updateStats=function(e){e.cachesize.length>0&&(t("#wpo_min_cache_size").html(this.enabled?e.cachesize:wpoptimize.no_minified_assets),t("#wpo_min_cache_total_size").html(this.enabled?e.total_cache_size:wpoptimize.no_minified_assets),t("#wpo_min_cache_time").html(this.enabled?e.cacheTime:"-"),t("#wpo_min_cache_path").html(e.cachePath))},n.minify_settings=function(){var i=t('[data-whichpage="wpo_minify"] .wp-optimize-nav-tab-contents form'),n={};return i.each(function(){var i=t(this);n=Object.assign(n,e(i))}),n},n.minify=o}(jQuery);