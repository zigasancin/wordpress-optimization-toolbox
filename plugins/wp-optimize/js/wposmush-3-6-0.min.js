jQuery(function(s){WP_Optimize_Smush=WP_Optimize_Smush()});var WP_Optimize_Smush=function(){function s(s){F("#smush-information-modal .smush-information").text(wposmush.server_check),D(F("#smush-information-modal")),data={server:wposmush.smush_settings.compression_server,skip_notice:!0},T("check_server_status",data,function(e){if(e.online){if(s.each(function(s,e){smush_image_list.push({attachment_id:parseInt(e.value),blog_id:wposmush.blog_id})}),data={optimization_id:"smush",selected_images:smush_image_list,smush_options:{compression_server:wposmush.smush_settings.compression_server,image_quality:wposmush.smush_settings.image_quality,lossy_compression:wposmush.smush_settings.lossy_compression,back_up_original:wposmush.smush_settings.back_up_original,preserve_exif:wposmush.smush_settings.preserve_exif}},smush_from_media_library=!0,smush_completed=!1,smush_timer_locked)return;D(F("#wpo_smush_images_information_container")),F("#wpo_smush_images_information_server").html(wposmush.smush_settings.compression_server),f(),smush_timer_handle=window.setInterval(r,1e3),T("process_bulk_smush",data)}else e.error?(error_message=e.error+"<br>"+wposmush.server_error,F("#smush-information-modal .smush-information").html(error_message)):F("#smush-information-modal .smush-information").text(wposmush.server_error),D(F("#smush-information-modal"),F.unblockUI)})}function e(s){smush_from_media_library=!0;var e=[],o=function(o){return function(a){e.push(o),1<e.length&&e.length===s.length?a(wposmush.images_restored_successfully):a()}};s.each(function(s,e){z(wposmush.blog_id,parseInt(e.value),o(parseInt(e.value)))})}function o(){var s=0==F('input[type="checkbox"]:checked',J).length;V.prop("disabled",s),X.prop("disabled",s)}function a(s,e){if(smush_mark_all_as_uncompressed){s=s?1:0,e=e?1:0;var o=F("#smush-information-modal-cancel-btn .smush-information");T("mark_all_as_uncompressed",{restore_backup:s,delete_only_backups_meta:e,skip_notice:!0},function(i){if(smush_mark_all_as_uncompressed)return i.hasOwnProperty("error")?(D(F("#smush-information-modal"),F.unblockUI),F("#smush-information-modal .smush-information").text(i.error),void m()):void(i.completed?(D(F("#smush-information-modal"),F.unblockUI),F("#smush-information-modal .smush-information").text(i.message),m()):(o.text(i.message),a(s,e)))})}}function n(s,e,o){var a=s.data("blog"),i=s.data("id"),n={attachment_id:i,blog_id:a},t=s.closest("#smush-metabox-inside-wrapper");data={selected_images:[n]},o===!1&&(data.unmark=!0),e.preventDefault(),D(wposmush.please_updating_images_info),T("mark_as_compressed",data,function(s){0==F("#smush-information-modal").length&&j(),F("#smush-information-modal .smush-information").text(s.summary),D(F("#smush-information-modal"),F.unblockUI),s.status&&(t.length&&(o?(F(".wpo_smush_single_image",t).hide(),F(".wpo-toggle-advanced-options",t).removeClass("opened"),F(".wpo_smush_mark_single_image",t).hide(),F(".wpo_smush_unmark_single_image",t).show(),F(".wpo_restore_single_image",t).show(),F("#smush_info",t).text(s.info)):(F(".wpo_smush_single_image",t).show(),F(".wpo_smush_mark_single_image",t).show(),F(".wpo_smush_unmark_single_image",t).hide(),F(".wpo_restore_single_image",t).hide(),F("#smush_info",t).text(s.info))),s.hasOwnProperty("media_column_html")&&q(a,i,s.media_column_html))})}function t(){F(this).toggleClass("opened"),F(this).hasClass("opened")?F(this).text(wposmush.less):F(this).text(wposmush.more)}function m(s){var s="undefined"==typeof s||s,e={use_cache:s};N.html("..."),Z.hide(),O(!0),Q.push(H.add_agent({_wait:!1,_keep:!1,command:"updraft_smush_ajax",command_data:{data:e,subaction:"get_ui_update"},callback:function(s){W(s,p),I(),O(!1),o()}})),ss=!0}function _(){F("#wpo_smush_images_grid input:checked").each(function(){image={attachment_id:F(this).val(),blog_id:F(this).data("blog")},smush_image_list.push(image)}),data={optimization_id:"smush",selected_images:smush_image_list,smush_options:{compression_server:F("input[name='compression_server']:checked").val(),image_quality:F("#image_quality").val(),lossy_compression:F("#smush-lossy-compression").is(":checked"),back_up_original:F("#smush-backup-original").is(":checked"),preserve_exif:F("#smush-preserve-exif").is(":checked")}},g(),Q.push(H.add_agent({_wait:!1,_keep:!1,command:"updraft_smush_ajax",command_data:{data:data,subaction:"process_bulk_smush"}}))}function u(){if(F("#wp-optimize-wrap").length){F("#wpo_smush_images_save_options_spinner").show().delay(3e3).fadeOut();var s=os();T("update_smush_options",s,function(s){F("#wpo_smush_images_save_options_spinner").hide(),s.hasOwnProperty("saved")&&s.saved?F("#wpo_smush_images_save_options_done").show().delay(3e3).fadeOut():F("#wpo_smush_images_save_options_fail").show().delay(3e3).fadeOut()})}}function r(){smush_timer_locked=!0,smush_total_seconds++,seconds=smush_total_seconds%60+""<10?"0"+smush_total_seconds%60:smush_total_seconds%60,minutes=parseInt(smush_total_seconds/60)+""<10?"0"+parseInt(smush_total_seconds/60):parseInt(smush_total_seconds/60),F("#smush_stats_timer").text(minutes+":"+seconds),c(smush_total_seconds)}function c(s){0==s%3&&l(s),0==s%60&&(null!=E&&(H.cancel_agent(E),E=null),Q.push(H.add_agent({_wait:!1,command:"updraft_smush_ajax",command_data:{data:{},subaction:"process_pending_images"},callback:function(s){W(s,b)}})))}function l(s){data={update_ui:!0,use_cache:!1};var e=s<5,o=H.add_agent({_wait:!e,_keep:!1,command:"updraft_smush_ajax",command_data:{data:data,subaction:"get_ui_update"},callback:function(s){W(s,b)}});null!==o&&(E=o,Q.push(o))}function p(s){if(J.html(""),s&&s.hasOwnProperty("unsmushed_images")){var e=s.unsmushed_images,o=s.pending_tasks,a=0;if(0==e.length&&0==o&&J.text(wposmush.all_images_compressed).wrapInner("<div class='wpo-fieldgroup'> </div>"),0!=o&&Z.show().find(".red").text(s.pending),1===s.is_multisite)a=uncompressed_images_sites_select.find(":selected").val(),d(a,s);else for(a in s.unsmushed_images)d(a,s)}}function h(s,e){return s.id-e.id}function d(s,e){var o="post.php?post=",a="&action=edit",n=e.admin_urls[s],t=e.unsmushed_images[s];"undefined"!=typeof t&&t.sort(h);for(i in t)if(t.hasOwnProperty(i)){var m=t[i];x(m,s,n+o+m.id+a)}}function g(){smush_timer_locked||(D(F("#wpo_smush_images_information_container")),service=F('.compression_server input[type="radio"]:checked + label small').text(),F("#wpo_smush_images_information_server").html(service),f(),smush_timer_handle=window.setInterval(r,1e3),O(!0))}function f(){F("#smush_stats_pending_images").html("..."),F("#smush_stats_completed_images").html("..."),F("#smush_stats_bytes_saved").html("..."),F("#smush_stats_percent_saved").html("..."),F("#smush_stats_timer").html("...")}function w(s){for(var e in s)s.hasOwnProperty(e)&&F("#post-"+e+" .column-wpo_smush").html(s[e]);S()}function b(s){F("#smush_stats_pending_images").html(s.pending_tasks),F("#smush_stats_completed_images").html(s.completed_task_count),F("#smush_stats_bytes_saved").html(s.bytes_saved),F("#smush_stats_percent_saved").html(s.percent_saved),1==s.smush_complete&&setTimeout(function(){k(function(){m(!1)})},1500)}function k(s){data={update_ui:!0,use_cache:!1,image_list:smush_image_list},function(s){Q.push(H.add_agent({_wait:!1,_keep:!1,command:"updraft_smush_ajax",command_data:{data:data,subaction:"get_ui_update"},callback:function(e){summary=e.session_stats,0!=e.completed_task_count&&(summary+="<hr>"+e.summary),v(summary),s instanceof Function&&s()}}))}(s)}function v(s){smush_completed||(F("#summary-message").html(s),y(),D(F("#smush-complete-summary")),smush_completed=!0,H.cancel_agents(Q))}function y(){smush_total_seconds=0,smush_timer_locked=!1,smush_completed=!1,smush_image_list=[],H.cancel_agents(Q),clearInterval(smush_timer_handle),O(!1)}function x(s,e,o){var a=["wpo_smush_",e,"_",s.id].join("");image_html='<div class="wpo_smush_image" data-filesize="'+s.filesize+'">',image_html+='<a class="button" href="'+o+'" target="_blank"> '+wposmush.view_image+" </a>",image_html+='<input id="'+a+'" type="checkbox" data-blog="'+e+'" class="wpo_smush_image__input" value="'+s.id+'">',image_html+='<label for="'+a+'"></a>',image_html+='<div class="thumbnail">',image_html+='<img class="lazyload" src="'+s.thumb_url+'">',image_html+="</div></label></div>",J.append(image_html)}function I(){features=wposmush.features,service=F("input[name^='compression_server']:checked").val();for(feature in features[service])F("."+feature).prop("disabled",!features[service][feature]);F(".wpo_smush_image").each(function(){F(this).data("filesize")>wposmush.features[service].max_filesize?F(this).hide():F(this).show()})}function O(s){F.each([V,G,L,B,A,X],function(e,o){o.prop("disabled",s)}),s?(F("#wpo_smush_images_refresh").hide(),F(".wpo_smush_images_loader").show()):(F("#wpo_smush_images_refresh").show(),F(".wpo_smush_images_loader").hide())}function U(s,e){0!=s.length&&(data={selected_image:s,smush_options:e},D(wposmush.compress_single_image_dialog),T("compress_single_image",data,function(s){W(s,P)}))}function z(s,e,o){if(0!=e.length){D(wposmush.please_wait,F.unblockUI);var a={blog_id:s,selected_image:e};T.apply({unique:!1},["restore_single_image",a,function(s){var e=function(e){"undefined"!=typeof e&&(s.summary=e),W(s,P)};o instanceof Function?o(e):e()}])}}function P(s){if(s.hasOwnProperty("success")&&s.success){0===F("#smush-information-modal").length&&j(),F(".smush-information").text(s.summary),D(F("#smush-information-modal"),F.unblockUI),F(".wpo-toggle-advanced-options.wpo_smush_single_image").removeClass("opened"),C(s.operation,s.summary,s.restore_possible,s);var e=s.blog_id||s.options.blog_id,o=s.image||s.options.attachment_id;smush_affected_images.hasOwnProperty(e)||(smush_affected_images[e]={}),smush_affected_images[e].hasOwnProperty(o)||(smush_affected_images[e][o]={}),s.hasOwnProperty("media_column_html")&&q(e,o,s.media_column_html),"compress"==s.operation?smush_affected_images[e][o]={operation:s.operation,summary:s.summary,restore_possible:s.restore_possible}:(o&&S(),smush_affected_images[e][o]={operation:s.operation})}else F(".smush-information").text(s.error_message),D(F("#smush-information-modal"),F.unblockUI)}function j(){F("body").append(['<div id="smush-information-modal" class="wp-core-ui" style="display:none;">','<div class="smush-information"></div>','<input type="button" class="wpo_primary_small button-primary information-modal-close" value="',wposmush.close,'" />',"</div>"].join(""))}function q(s,e,o){F(['.wpo-smush-media-library-column[data-blog="',s,'"][data-id="',e,'"]'].join("")).parent().html(o)}function C(s,e,o,a){var i=F("#smush_info").closest("#smush-metabox-inside-wrapper");0!==i.length&&("compress"==s?(F(".wpo_smush_single_image").hide(),F(".wpo_restore_single_image").show(),a&&a.hasOwnProperty("sizes-info")?(F("#smush_info").text(e),F("#wpo_smush_details").html(a["sizes-info"])):(F("#smush_info").text(e),F("#wpo_smush_details").text("").hide()),F(".wpo_smush_mark_single_image").hide(),o?F(".restore_possible").show():F(".restore_possible").hide()):(F(".wpo_smush_single_image").show(),F(".wpo_restore_single_image").hide(),F(".wpo_smush_mark_single_image").show(),F(".wpo_smush_unmark_single_image",i).hide()))}function D(s,e){F.blockUI({message:s,onOverlayClick:e,baseZ:160001,css:{top:"50%",transform:"translate(0, -50%)",width:"400px",padding:"20px",cursor:"pointer"}})}function W(s,e){s&&s.hasOwnProperty("status")&&s.status?e&&e(s):(alert(wposmush.error_unexpected_response),console.log(s))}function K(){return F('input[name="media[]"]:checked')}function M(){var s=[],e=K();return e.each(function(e,o){s.push(parseInt(o.value))}),s}function S(){F("#bulk-action-selector-top, #bulk-action-selector-bottom").val("-1"),F('input[name="media[]"]:checked, #cb-select-all-1, #cb-select-all-2').prop("checked",!1)}function T(s,e,o,a){a="undefined"==typeof a||a,e=F.isEmptyObject(e)?{use_cache:!1}:e,function(o,i,n){Q.push(H.add_agent({_wait:!1,_keep:i,_unique:n,command:"updraft_smush_ajax",command_data:{data:e,subaction:s},callback:function(s){if(a){try{var e=wpo_parse_json(s)}catch(i){console.log("smush_manager_send_command JSON parse error"),console.log(i),console.log(s),alert(wposmush.error_unexpected_response)}"undefined"!=typeof o&&o(e)}else"undefined"!=typeof o&&o(s)}}))}(o,this.keep,this.unique)}var F=jQuery,H=WP_Optimize_Heartbeat(),Q=[],E=null,J=(F("#wp-optimize-images-nav-tab-smush"),F("#wpo_smush_images_grid")),N=F("#smush_info_images"),Z=F("#wpo_smush_images_pending_tasks_container"),A=F("#wpo_smush_images_pending_tasks_button"),B=F("#wpo_smush_images_refresh"),G=F("#wpo_smush_images_select_all"),L=F("#wpo_smush_images_select_none"),R=F("#wpo_smush_clear_stats_btn"),V=F("#wpo_smush_images_btn"),X=F("#wpo_smush_mark_as_compressed"),Y=(F(".wpo_smush_single_image .button"),F(".wpo_restore_single_image .button"),F(".wpo_smush.column-wpo_smush .convert-to-webp"));smush_mark_all_as_uncompressed_btn=F("#wpo_smush_mark_all_as_uncompressed_btn"),restore_all_compressed_images_btn=F("#wpo_smush_restore_all_compressed_images_btn"),smush_view_logs_btn=F(".wpo_smush_get_logs"),smush_delete_backup_images_btn=F("#wpo_smush_delete_backup_btn"),compression_server_select=F(".compression_server"),reset_webp_serving_method_btn=F("#wpo_reset_webp_serving_method"),smush_images_tab_loaded=!1,smush_service_features=[],smush_total_seconds=0,smush_timer_locked=!1,smush_timer_handle=0,smush_image_list=[],smush_completed=!1,smush_from_media_library=!1,smush_mark_all_as_uncompressed=!1,smush_affected_images={},pending_tasks_cancel_btn=F("#wpo_smush_images_pending_tasks_cancel_button"),uncompressed_images_sites_select=F("#wpo_uncompressed_images_sites_select"),F("#doaction, #doaction2").on("click",function(o){o.stopImmediatePropagation();var a=F(this).prev("select").val();if("wp_optimize_bulk_compression"===a||"wp_optimize_bulk_restore"===a){var i=K();0!==i.length&&(o.preventDefault(),"wp_optimize_bulk_compression"===a&&s(i),"wp_optimize_bulk_restore"===a&&e(i))}}),J.on("click",".thumbnail",function(s){F(this).closest('input[type="checkbox"]').prop("checked",!0)});var $=!1;J.on("mousedown",".thumbnail",function(s){$=s.shiftKey||s.ctrlKey}),J.on("mouseup",".thumbnail",function(s){$=s.shiftKey||s.ctrlKey}),reset_webp_serving_method_btn.on("click",function(s){s.preventDefault(),T("reset_webp_serving_method",{skip_notice:!0},function(s){s.success?F("#wpo_reset_webp_serving_method_done").show().delay(3e3).fadeOut():(F("#enable_webp_conversion").prop("checked",!1),F("#smush-information-modal .smush-information").text(s.error_message),D(F("#smush-information-modal")))})});var ss=!1;F("#wp-optimize-nav-tab-wrapper__wpo_images .nav-tab").on("click",function(){ss||F(this).is("#wp-optimize-nav-tab-wpo_images-smush")&&m(!1)}),F("#wp-optimize-wrap").on("page-change",function(s,e){ss||"wpo_images"==e.page&&F("#wp-optimize-nav-tab-wrapper__wpo_images .nav-tab-active").is("#wp-optimize-nav-tab-wpo_images-smush")&&m(!1)}),F("#smush-metabox").length>0&&I();var es=null;J.on("click",".wpo_smush_image",function(s){var e=F('#wpo_smush_images_grid input[type="checkbox"]'),a=F(this).find(".wpo_smush_image__input"),i=!a.prop("checked");if(es||(F(this).find(".wpo_smush_image__input").prop("checked",i),es=a),!0===$){var n=e.index(a),t=e.index(es);n===t?e.slice(Math.min(n,t),Math.max(n,t)+1).prop("checked",i):!0===es.prop("checked")&&e.slice(Math.min(n,t),Math.max(n,t)+1).prop("checked",i)}es=a,o()}),o(),compression_server_select.on("change",function(s){I(),u()}),V.off().on("click",function(){return 0==F('#wpo_smush_images_grid input[type="checkbox"]:checked').length?(F("#smush-information-modal .smush-information").text(wposmush.please_select_images),void D(F("#smush-information-modal"),F.unblockUI)):(F("#smush-information-modal .smush-information").text(wposmush.server_check),D(F("#smush-information-modal")),data={server:F("input[name='compression_server']:checked").val(),skip_notice:!0},void T("check_server_status",data,function(s){s.online?_():(s.error?(error_message=s.error+"<br>"+wposmush.server_error,F("#smush-information-modal .smush-information").html(error_message)):F("#smush-information-modal .smush-information").text(wposmush.server_error),D(F("#smush-information-modal"),F.unblockUI))}))}),X.off().on("click",function(){if(0==F('#wpo_smush_images_grid input[type="checkbox"]:checked').length)return F("#smush-information-modal .smush-information").text(wposmush.please_select_compressed_images),void D(F("#smush-information-modal"),F.unblockUI);var s,e=[];F("#wpo_smush_images_grid input:checked").each(function(){s={attachment_id:F(this).val(),blog_id:F(this).data("blog")},e.push(s)}),D(wposmush.please_updating_images_info),T("mark_as_compressed",{selected_images:e},function(s){F("#smush-information-modal .smush-information").text(s.summary),D(F("#smush-information-modal"),F.unblockUI),m()})}),smush_mark_all_as_uncompressed_btn.on("click",function(){if(confirm(wposmush.mark_all_images_uncompressed)){var s=confirm(wposmush.restore_images_from_backup);D(F("#smush-information-modal-cancel-btn")),F("#smush-information-modal-cancel-btn .smush-information").text(wposmush.please_wait),smush_mark_all_as_uncompressed=!0,a(s)}}),restore_all_compressed_images_btn.on("click",function(){confirm(wposmush.restore_all_compressed_images)&&(D(F("#smush-information-modal-cancel-btn")),F("#smush-information-modal-cancel-btn .smush-information").text(wposmush.please_wait),smush_mark_all_as_uncompressed=!0,a(!0,!0))}),F('#smush-information-modal-cancel-btn input[type="button"]').on("click",function(){smush_mark_all_as_uncompressed=!1,m(),F.unblockUI()}),B.off().on("click",function(){m(!1)}),G.off().on("click",function(){F('#wpo_smush_images_grid input[type="checkbox"]').prop("checked",!0),es=null,o()}),L.off().on("click",function(){F('#wpo_smush_images_grid input[type="checkbox"]').prop("checked",!1),es=null,o()}),smush_view_logs_btn.off().on("click",function(){F("#log-panel").text("Please wait, fetching logs."),T("get_smush_logs",{},function(s){F.blockUI({message:F("#smush-log-modal"),onOverlayClick:F.unblockUI(),css:{width:"80%",height:"80%",top:"15%",left:"15%"}}),F("#log-panel").html("<pre>"+s+"</pre>"),download_link=ajaxurl+"?action=updraft_smush_ajax&subaction=get_smush_logs&nonce="+wposmush.smush_ajax_nonce,F("#smush-log-modal a").attr("href",download_link)},!1)}),smush_delete_backup_images_btn.on("click",function(){if(confirm(wposmush.delete_image_backup_confirm)){smush_delete_backup_images_btn.prop("disabled",!0);var s=F("#wpo_smush_delete_backup_spinner"),e=F("#wpo_smush_delete_backup_done");s.show(),T("clean_all_backup_images",{},function(){s.hide(),smush_delete_backup_images_btn.prop("disabled",!1),e.css("display","inline-block").delay(3e3).fadeOut()})}}),R.off().on("click",function(s){F("#wpo_smush_images_clear_stats_spinner").show().delay(3e3).fadeOut(),T("clear_smush_stats",{},function(s){F("#wpo_smush_images_clear_stats_spinner").hide(),F("#wpo_smush_images_clear_stats_done").show().delay(3e3).fadeOut()})}),A.off().on("click",function(s){F("#smush-information-modal .smush-information").text(wposmush.server_check),D(F("#smush-information-modal"),F.unblockUI),data={server:F("input[name='compression_server']:checked").val(),skip_notice:!0},T("check_server_status",data,function(s){s.online?(g(),T("process_pending_images",{},function(s){W(s,b)})):(s.error?(error_message=s.error+"<br>"+wposmush.server_error,F("#smush-information-modal .smush-information").html(error_message)):F("#smush-information-modal .smush-information").text(wposmush.server_error),D(F("#smush-information-modal"),F.unblockUI))})}),F("body").on("click","#wpo_smush_images_pending_tasks_cancel_button",function(s){wposmush.cancel===pending_tasks_cancel_btn.val()&&(pending_tasks_cancel_btn.val(wposmush.cancelling),pending_tasks_cancel_btn.prop("disabled",!0)),T("clear_pending_images",{},function(s){F.unblockUI(),s.status?(m(),y()):console.log("Cancelling pending images apparently failed.",s),pending_tasks_cancel_btn.val(wposmush.cancel),pending_tasks_cancel_btn.prop("disabled",!1)})}),F(".column-wpo_smush").on("click",".wpo-smush-compress-popup-btn",function(s){var e=F(this).data("id"),o=F(this).data("blog");s.preventDefault(),T("get_smush_settings_form",{attachment_id:e,blog_id:o},function(s){if(s.success){var a=['<div class="wpo-smush-compress-popup-content">',"<h3>",wposmush.compress_image,"</h3>",s.html,"</div>",'<div class="wpo_smush_single_image action_button" style="display:inline-block;">','<input type="button" data-blog="',o,'" data-id="',e,'" id="smush_compress_',e,'" class="button-primary button" value="',wposmush.compress,'">',"</div>","&nbsp;&nbsp;",'<a href="#" class="button wpo-smush-popup-cancel-btn">',wposmush.close,"</a>"].join("");D(a,F.unblockUI)}})}),F("body").on("click",".wpo-smush-popup-cancel-btn",function(s){s.preventDefault(),F.unblockUI()}),F("body").on("click",".wpo_smush_single_image .button",function(){image={attachment_id:F(this).data("id"),blog_id:F(this).data("blog")},F("#enable_custom_compression").is(":checked")?image_quality=F("#custom_compression_slider").val():image_quality=F("#enable_lossy_compression").is(":checked")?60:92,lossy_compression=image_quality<92,smush_options={compression_server:F("input[name='compression_server_"+image.attachment_id+"']:checked").val(),image_quality:image_quality,lossy_compression:lossy_compression,back_up_original:F("#smush_backup_"+image.attachment_id).is(":checked"),preserve_exif:F("#smush_exif_"+image.attachment_id).is(":checked")},data={server:F("input[name='compression_server_"+F(this).attr("id").substring(15)+"']:checked").val()},D(wposmush.server_check),T("check_server_status",data,function(s){s.online?U(image,smush_options):s.error?(error_message=s.error+"<br>"+wposmush.server_error,D(error_message,F.unblockUI)):D(wposmush.server_error,F.unblockUI)})}),F("body").on("click",".wpo_restore_single_image .button, .wpo_restore_single_image a",function(s){var e=F(this);blog_id=e.data("blog"),image_id=e.data("id"),s.preventDefault(),image_id&&blog_id&&z(blog_id,image_id)}),F("body").on("click",".wpo_smush_mark_single_image .button, .wpo_smush_mark_single_image a",function(s){n(F(this),s,!0)}),F("body").on("click",".wpo_smush_unmark_single_image .button, .wpo_smush_unmark_single_image a",function(s){n(F(this),s,!1)}),F("body").on("click","#wpo_smush_details .wpo-collapsible",t),F("body").on("click",".column-wpo_smush .wpo-collapsible",t),F("body").on("click","#smush-log-modal .close, #smush-information-modal .information-modal-close",function(){F.unblockUI(),smush_from_media_library&&S()}),F("body").on("click",".wpo_smush_stats_cta_btn, .wpo_smush_get_logs, #smush-complete-summary .close",function(){if(F.unblockUI(),smush_from_media_library){var s=M();T("get_smush_details",{selected_images:s},function(s){s.success?(window.clearInterval(smush_timer_handle),w(s.smush_details)):console.log(s)})}else m(),setTimeout(y,500)}),F("body").on("click",".wpo-toggle-advanced-options",function(s){s.preventDefault(),F(this).toggleClass("opened")}),F(".wpo-fieldgroup .autosmush input, .wpo-fieldgroup .compression_level, .wpo-fieldgroup .image_options, #smush-show-metabox").on("change",function(s){u()}),F("body").on("change",".smush-options.compression_level",function(){F("#enable_custom_compression").is(":checked")?F(".smush-options.custom_compression").show():F(".smush-options.custom_compression").hide()}),F("body").on("change",'.smush-advanced input[type="radio"]',function(){I()}),F("#enable_webp_conversion").on("change",function(s){if(F("#wp-optimize-wrap").length){F("#wpo_smush_images_save_options_spinner").show().delay(3e3).fadeOut(),F("#enable_webp_conversion").prop("disabled",!0);var e=os();e.skip_notice=!0,T("update_webp_options",e,function(s){if(F("#wpo_smush_images_save_options_spinner").hide(),s.hasOwnProperty("saved")&&s.saved)F("#wpo_smush_images_save_options_done").show().delay(3e3).fadeOut();else{if(F("#enable_webp_conversion").prop("checked",!1),"update_failed_no_working_webp_converter"===s.error_code){var e="<p>"+wposmush.webp_conversion_tool_error+' <a href="https://getwpo.com/faqs/#How-can-I-get-WebP-conversion-tools-to-work-" target="_blank">'+wposmush.webp_conversion_tool_how_to+"</a></p>";F("#smush-information-modal .smush-information").html(e)}else F("#smush-information-modal .smush-information").text(s.error_message);D(F("#smush-information-modal"))}F("#enable_webp_conversion").prop("disabled",!1)})}}),Y.on("click",function(s){s.preventDefault();var e=F(this);data={attachment_id:F(this).data("attachment-id"),skip_notice:!0},D(wposmush.converting_to_webp),T("convert_to_webp_format",data,function(s){s.error?(D(s.error,F.unblockUI),setTimeout(function(){F.unblockUI()},2e3)):(D(s.success,F.unblockUI),setTimeout(function(){F.unblockUI()},2e3),e.next().remove(),e.remove())})}),uncompressed_images_sites_select.on("change",function(){m()}),F(document).on("admin-metabox-smush-loaded",function(){var s=F('.wpo_restore_single_image input[type="button"]').first().data();if(s&&smush_affected_images.hasOwnProperty(s.blog)&&smush_affected_images[s.blog].hasOwnProperty(s.id)){var e=smush_affected_images[s.blog][s.id];"compress"==e.operation?C(e.operation,e.summary,e.restore_possible,e):C(e.operation)}}),H.setup();var os=function(){var s="";s=F("#enable_custom_compression").is(":checked")?F("#custom_compression_slider").val():F("#enable_lossy_compression").is(":checked")?60:92;var e=s<92;return{compression_server:F("input[name='compression_server']:checked").val(),image_quality:s,lossy_compression:e,back_up_original:F("#smush-backup-original").is(":checked"),back_up_delete_after:F("#smush-backup-delete").is(":checked"),back_up_delete_after_days:F("#smush-backup-delete-days").val(),preserve_exif:F("#smush-preserve-exif").is(":checked"),autosmush:F("#smush-automatically").is(":checked"),show_smush_metabox:F("#smush-show-metabox").is(":checked"),webp_conversion:F("#enable_webp_conversion").is(":checked")}};wp_optimize.smush_settings=os};